// Валидация сложности пароля
const validatePassword = (password) => {
  const errors = [];
  
  // Минимальная длина 8 символов
  if (password.length < 8) {
    errors.push('Пароль должен содержать минимум 8 символов');
  }
  
  // Должна быть хотя бы одна заглавная буква
  if (!/[A-ZА-Я]/.test(password)) {
    errors.push('Пароль должен содержать хотя бы одну заглавную букву');
  }
  
  // Должна быть хотя бы одна строчная буква
  if (!/[a-zа-я]/.test(password)) {
    errors.push('Пароль должен содержать хотя бы одну строчную букву');
  }
  
  // Должна быть хотя бы одна цифра
  if (!/[0-9]/.test(password)) {
    errors.push('Пароль должен содержать хотя бы одну цифру');
  }
  
  // Должен быть хотя бы один специальный символ
  if (!/[!@#$%^&*()_+\-=\[\]{};':"\\|,.<>\/?]/.test(password)) {
    errors.push('Пароль должен содержать хотя бы один специальный символ (!@#$%^&* и т.д.)');
  }
  
  // Максимальная длина (защита от слишком длинных паролей)
  if (password.length > 128) {
    errors.push('Пароль не должен превышать 128 символов');
  }
  
  return {
    isValid: errors.length === 0,
    errors
  };
};

module.exports = { validatePassword };